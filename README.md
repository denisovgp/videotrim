# VideoTrim - Конвертер видео в MP3 с транскрипцией

Скрипт для конвертации видео файлов в сжатые MP3 файлы и автоматической транскрипции через OpenRouter API с таймстемпами для каждого слова.

## Требования

- Python 3.6+
- ffmpeg (должен быть установлен в системе)
- OpenRouter API ключ

### Установка зависимостей

**Python зависимости:**
```bash
pip install -r requirements.txt
```

**Установка ffmpeg:**

**macOS:**
```bash
brew install ffmpeg
```

**Ubuntu/Debian:**
```bash
sudo apt install ffmpeg
```

**Windows:**
Скачайте с [официального сайта](https://ffmpeg.org/download.html) и добавьте в PATH.

### Настройка OpenRouter API

1. Получите API ключ на [OpenRouter.ai](https://openrouter.ai/)
2. Установите переменную окружения:
```bash
export OPENROUTER_API_KEY='your-api-key'
```

Или создайте файл `.env` в корне проекта:
```
OPENROUTER_API_KEY=your-api-key
```

## Использование

```bash
python video_to_mp3.py <путь_к_видео> [bitrate] [--no-transcribe]
```

### Примеры

```bash
# Конвертация с битрейтом по умолчанию (128k) и транскрипцией
python video_to_mp3.py video.mp4

# Конвертация с указанным битрейтом и транскрипцией
python video_to_mp3.py video.mp4 192k

# Конвертация без транскрипции
python video_to_mp3.py video.mp4 192k --no-transcribe
```

## Выходные файлы

Все файлы сохраняются в папку `output/<timestamp>/`, где timestamp - это дата и время конвертации в формате `YYYYMMDD_HHMMSS`.

### Формат выходных файлов

**MP3 файл:**
- Кодек: MP3 (libmp3lame)
- Битрейт: 128k (по умолчанию) или указанный
- Частота дискретизации: 44100 Hz

**JSON файл с транскрипцией:**
```json
{
  "text": "полный текст транскрипции",
  "words": [
    {
      "word": "слово",
      "start": 0.0,
      "end": 0.5
    }
  ]
}
```

Где `start` и `end` - время начала и конца каждого слова в секундах.

## Модель транскрипции

По умолчанию используется модель `mistralai/voxtral-small-24b-2507` через OpenRouter API. Это одна из самых дешевых моделей для транскрипции речи.

## Примечания

- Транскрипция выполняется автоматически после конвертации видео в MP3
- Для пропуска транскрипции используйте флаг `--no-transcribe`
- Таймстемпы предоставляются моделью и могут иметь ограниченную точность
- Большие аудио файлы могут требовать больше времени для обработки

